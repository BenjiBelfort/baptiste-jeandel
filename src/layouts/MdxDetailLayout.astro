---
import PageTitle from "@/components/PageTitle.astro";
import StickyDevis from "@/components/StickyDevis.astro";
import StickySectionHint from "@/components/StickySectionHint.astro";

type Props = {
  title: string;
  excerpt?: string;
  domain: string;
  slug: string;
  ctaMessage?: string;
  ctaLabel?: string;
  image?: string;
  stickyColor?: string;
};

const {
  title,
  excerpt,
  domain,
  slug,
  ctaMessage,
  ctaLabel = "Demander un devis",
  image,
  stickyColor,
} = Astro.props;
---

<PageTitle title={title} subtitle={excerpt} />

<StickySectionHint title={title} />

{image && (
  <div class="relative z-10 h-48 -mt-6">  <!-- hauteur fixe + chevauchement -->
    <img
      src={image}
      alt={`Illustration â€” ${title}`}
      class="h-48 max-h-48 w-auto max-w-[75vw] mx-auto object-contain drop-shadow-xl
             absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"
      loading="lazy"
      decoding="async"
      fetchpriority="low"
    />
  </div>
)}

<article class="prose max-w-3xl mx-auto px-4 pb-28 mdx">
  <slot />
</article>

<StickyDevis
  domain={domain}
  origin={`${Astro.url.pathname.startsWith('/services') ? 'services' : 'formations'}/${slug}`}
  message={ctaMessage}
  label={ctaLabel}
  color={stickyColor}
/>
