---
import Site from '@/layouts/SiteLayout.astro';
import { getCollection } from 'astro:content';

const items = (await getCollection('formations')).sort((a,b)=>a.data.sort - b.data.sort);
---
<Site title="Formations — Baptiste Jeandel" description="Formations proposées.">
  <section class="max-w-6xl mx-auto px-4 py-12 grid gap-6 md:grid-cols-3">
    {items.map((entry) => (
      <article class="border rounded-xl p-6">
        <h2 class="text-lg font-semibold">{entry.data.title}</h2>
        <p class="mt-2 text-sm text-gray-600">{entry.data.excerpt}</p>
        <!-- DEBUG inline : affiche le slug pour vérifier -->
        <p class="text-xs text-gray-500 mt-1">slug: {entry.slug}</p>
        <div class="mt-4 flex gap-3">
          <a class="underline" href={`/formations/${entry.slug}`}>En savoir +</a>
        <a
            class="inline-flex items-center px-3 py-2 rounded-lg border"
            href={`/contact?domain=${encodeURIComponent(entry.data.domain)}&origin=${encodeURIComponent(`formations/${entry.slug}`)}`}
        >
            Demander un devis
        </a>
        </div>
      </article>
    ))}
  </section>
</Site>
